(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[222],{5248:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return t(7772)}])},7720:function(e,s,t){"use strict";var a=t(5893),n=t(7294),r=t(5007),l=t(796),c=t(7741),i=t(9633),o=t(4687),d=t(1163),u=t(5273);s.Z=function(e){let{image:s,price:t,quantity:h,number:m,name:p,productId:x,removeBtn:j,maxCount:_,orderQuantity:f}=e,{loginData:N}=(0,r.v9)(i.YN),{guestUserId:k}=(0,r.v9)(l.KY),v=(0,r.I0)(),{pathname:g}=(0,d.useRouter)(),y=e=>{v((0,c.IV)({userToken:N.access_token,productId:e,guestUserId:k}))},b=(e,s,t,a)=>{"-"===t&&(s>1?v((0,c.u_)({userToken:N.access_token,productId:e,productCount:1*s-1,guestUserId:k})):v((0,c.IV)({userToken:N.access_token,productId:e,guestUserId:k}))),"+"===t&&s<a&&v((0,c.u_)({userToken:N.access_token,productId:e,productCount:1*s+1,guestUserId:k}))};return(0,n.useEffect)(()=>{},[g]),(0,a.jsxs)("div",{className:"basket__item",children:[(0,a.jsx)("p",{children:m}),(0,a.jsx)("div",{className:"basket__item-img",children:(0,a.jsx)("img",{src:u.S+s,alt:"img"})}),(0,a.jsx)("h4",{children:p}),(0,a.jsxs)("p",{className:"price",children:[t," ₽"]}),(0,a.jsx)("div",{className:"counter",children:(0,a.jsx)("div",{className:"counter-flex",children:"/checkout"!==g&&"/orderSingle/[id]"!==g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>b(x,h,"-",_),children:(0,a.jsx)(o.V_,{})}),(0,a.jsx)("span",{children:h}),(0,a.jsx)("button",{onClick:()=>b(x,h,"+",_),children:(0,a.jsx)(o.pO,{})})]}):(0,a.jsx)("span",{children:f||h})})}),(0,a.jsxs)("p",{className:"total-price",children:[f?f*t:h*t," ₽"]}),"/checkout"!==g&&"/orderSingle/[id]"!==g?(0,a.jsx)("button",{className:"remove-btn",onClick:()=>y(x),children:(0,a.jsx)(o.HF,{})}):""]})}},1575:function(e,s,t){"use strict";var a=t(5893),n=t(7294),r=t(7720),l=t(5007),c=t(796),i=t(7741),o=t(9633),d=t(1163);s.Z=function(){let{cartData:e,guestUserId:s}=(0,l.v9)(c.KY),[t,u]=(0,n.useState)(!1),{loginData:h}=(0,l.v9)(o.YN),m=(0,l.I0)(),{pathname:p}=(0,d.useRouter)();return(0,n.useEffect)(()=>{e.length<1&&!t&&(m((0,i.x7)({userToken:h.access_token,guestUserId:s})),u(!0))},[e]),(0,n.useEffect)(()=>{},[p]),(0,a.jsxs)("div",{className:"basket__products",children:[(0,a.jsxs)("div",{className:"basket__products-title",children:[(0,a.jsx)("p",{children:"№"}),(0,a.jsx)("p",{children:"Фото"}),(0,a.jsx)("p",{children:"Наименование"}),(0,a.jsx)("p",{children:"Цена"}),(0,a.jsx)("p",{children:"Количество"}),(0,a.jsx)("p",{children:"Сумма"}),"/checkout"!==p?(0,a.jsx)("p",{children:"удалить"}):""]}),e.length&&(null==e?void 0:e.map((e,s)=>{var t,n;return(0,a.jsx)(r.Z,{image:e.attributes.image,price:e.price,quantity:e.quantity&&e.quantity,number:s+1,name:e.name,productId:e.id,removeBtn:!0,maxCount:(null===(t=e.conditions)||void 0===t?void 0:t.quantity)&&(null===(n=e.conditions)||void 0===n?void 0:n.quantity)},e.id)}))]})}},8232:function(e,s,t){"use strict";var a=t(5893),n=t(1664),r=t.n(n),l=t(7294);s.Z=function(e){let{title:s,links:t}=e;return(0,a.jsx)("div",{className:"brendcrumbs",children:(0,a.jsxs)("div",{className:"brendcrumbs__container _container",children:[(0,a.jsx)(r(),{href:"/",children:"Главная"}),(0,a.jsx)("svg",{width:6,height:10,viewBox:"0 0 6 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M-5.13609e-08 1.175L3.7085 5L-3.85753e-07 8.825L1.1417 10L6 5L1.1417 -2.12363e-07L-5.13609e-08 1.175Z",fill:"#333333"})}),(null==t?void 0:t.length)?t.map((e,s)=>(0,a.jsxs)(l.Fragment,{children:[(0,a.jsx)(r(),{href:e.link,children:e.name}),(0,a.jsx)("svg",{width:6,height:10,viewBox:"0 0 6 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M-5.13609e-08 1.175L3.7085 5L-3.85753e-07 8.825L1.1417 10L6 5L1.1417 -2.12363e-07L-5.13609e-08 1.175Z",fill:"#333333"})})]},s)):"",(0,a.jsx)("p",{children:s})]})})}},7772:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var a=t(5893),n=t(8232),r=t(7294),l=t(5007),c=t(9633),i=t(2175),o=t(6310),d=t(6627),u=t.n(d),h=t(7066),m=t(796),p=t(9332);t(9184);var x=t(6978),j=t(1575),_=t(2870),f=t(1664),N=t.n(f),k=t(7741),v=t(4687),g=t(5273),y=function(){let{usersData:e,loginData:s}=(0,l.v9)(c.YN),[t,n]=(0,r.useState)(!1),[d,f]=(0,r.useState)(!1),{totalPrice:y,guestUserId:b}=(0,l.v9)(m.KY),[C,E]=(0,r.useState)(!1),[w,D]=(0,r.useState)(!1),T=(0,l.I0)(),[Z,B]=(0,r.useState)(!1),L=(0,p.useRouter)(),S=(0,r.useRef)(null),I=o.Ry().shape({name:o.Z_().typeError("Напишите свое имя").min(3,"Слишком короткое имя").required("Обязательное поле"),lastName:o.Z_().typeError("Напишите свое отчество").min(3,"Слишком короткое отчество").required("Обязательное поле"),email:o.Z_().typeError("Пример: example@mail.ru").email("Недопустимый формат").required("Обязательное поле"),phone:o.Z_().min(3,"Слишком короткий номер").matches(/[0-9]/,"Только цифры").required("Обязательное поле"),fatherName:o.Z_(),city:o.Z_().required("Обязательное поле")});(0,r.useEffect)(()=>{t||(s.access_token&&T((0,x.BT)({userToken:s.access_token})),n(!0))},[y,e]);let q=(0,r.useCallback)(()=>{D(!1)},[]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("section",{className:"checkout",children:(0,a.jsxs)("div",{className:"checkout__container _container",ref:S,children:[(0,a.jsx)("h1",{children:"Оформление заказа"}),(0,a.jsx)(j.Z,{}),(0,a.jsx)(i.J9,{initialValues:{name:e.name,lastName:e.lastName,fatherName:e.fatherName?e.fatherName:"",phone:e.phone,email:e.email,created_at:e.created_at,company:e.company?e.company:"",city:e.city?e.city:"",post:e.post?e.post:"",country:e.country?e.country:"",region:e.region?e.region:""},onSubmit:async(t,a)=>{let{resetForm:n}=a,r={};e.name?await h.Z.post("".concat(g.S,"/api/auth/create-order"),{cmd:1,address_id:d?e.address.filter(e=>!0===e.checked)[0].id:{name:t.name,lastName:t.lastName,fatherName:t.fatherName,phone:t.phone,email:t.email,created_at:t.created_at,company:t.company,address_1:"values.address_1",address_2:"values.address_2",country:"values.country",post:"values.post",city:t.city,region:t.region,total:y,user_id:e.id,delivery:1,grant_total:y,note:""}},{headers:{Authorization:"Bearer "+s.access_token}}).then(e=>{D(200===e.status),setTimeout(()=>{T((0,k.x7)({userToken:s.access_token})),L.push("/orders")},1900)}):(await h.Z.post("${fakeUrl}/api/auth/registration",{name:t.name,lastName:t.lastName,phone:t.phone,email:t.email,password:"65654654",password_confirmation:"65654654",subscribed:!1}).then(e=>{B(!1),r={...e.data}}).catch(e=>{e.response.data.error.email&&(B(!0),window.scrollTo(S.current.offsetTop,0))}),r.access_token&&(T((0,c.Ib)({loginData:r,save:!0})),T((0,x.BT)({userToken:r.access_token})),await h.Z.post("".concat(g.S,"/api/auth/create-order"),{cmd:e.name?1:2,uuId:b,address_id:{name:t.name,lastName:t.lastName,fatherName:t.fatherName,phone:t.phone,email:t.email,created_at:t.created_at,company:t.company,address_1:"values.address_1",address_2:"values.address_2",country:"values.country",post:"values.post",city:t.city,region:t.region,total:y,user_id:e.id,delivery:1,grant_total:y,note:""}},{headers:{Authorization:"Bearer "+r.access_token}}).then(e=>{D(200===e.status),T((0,x.AU)({userToken:r.access_token,limit:20,page:1})),setTimeout(()=>{T((0,k.x7)({userToken:r.access_token})),L.push("/orders")},1900)}))),n()},validateOnBlur:!0,validationSchema:d?null:I,children:s=>{let{values:t,errors:n,touched:r,handleChange:l,handleBlur:c,isValid:o,dirty:h,handleSubmit:m}=s;return(0,a.jsxs)(i.l0,{autoComplete:"off",onSubmit:m,className:"checkout__form",children:[(0,a.jsx)("div",{className:"checkout__form-left",children:(0,a.jsx)("div",{className:"checkout__select",children:(0,a.jsxs)("div",{className:"checkout__select-item",children:[(0,a.jsxs)("div",{className:"title",children:[(0,a.jsx)(v.OX,{}),(0,a.jsx)("p",{children:"Способ оплаты"})]}),(0,a.jsxs)("label",{className:"checkbox",onClick:()=>E(!0),children:[(0,a.jsx)("input",{type:"checkbox",checked:!!C}),(0,a.jsx)("span",{}),(0,a.jsx)("p",{children:"Наличными при получении"})]}),(0,a.jsxs)("label",{className:"checkbox",onClick:()=>E(!1),children:[(0,a.jsx)("input",{type:"checkbox",checked:!C,defaultChecked:!0}),(0,a.jsx)("span",{}),(0,a.jsx)("p",{children:"Робокасса"})]})]})})}),(0,a.jsxs)("div",{className:"checkout__right",children:[(0,a.jsxs)("h2",{children:[(0,a.jsx)(v.Dw,{}),"Детали заказа"]}),!e.name&&(0,a.jsxs)("div",{className:"user-buttons",children:[(0,a.jsx)(N(),{href:"/login",children:"Вход /"}),(0,a.jsx)(N(),{href:"/registration",children:" Регистрация"})]}),d?"":(0,a.jsxs)("div",{className:"checkout__newadres",children:[(0,a.jsxs)("label",{className:"input-text",children:["Фамилия *",(0,a.jsx)(i.gN,{type:"text",className:"input",placeholder:"Иванов",name:"lastName",defaultValue:e.lastName,autoComplete:"off",style:{borderColor:n.lastName&&r.lastName?"red":"#EDEDED"},onChange:l,onBlur:c})]}),(0,a.jsxs)("label",{className:"input-text",children:["Имя *",(0,a.jsx)(i.gN,{type:"text",className:"input",placeholder:"Иван",name:"name",defaultValue:e.name,autoComplete:"off",style:{borderColor:n.name&&r.name?"red":"#EDEDED"},onChange:l,onBlur:c})]}),(0,a.jsxs)("label",{className:"input-text",children:["Отчество",(0,a.jsx)(i.gN,{type:"text",className:"input",placeholder:"Иванович",autoComplete:"off",name:"fatherName",style:{borderColor:n.fatherName&&r.fatherName?"red":"#EDEDED"},onChange:l,onBlur:c})]}),(0,a.jsxs)("label",{className:"input-text",style:{color:Z?"red":"rgba(51, 51, 51, 0.6)"},children:[Z?"Данный E-Mail уже зарегистрирован!":"Эл. адрес *",(0,a.jsx)(i.gN,{type:"text",className:"input",placeholder:"ivan.ivanovich@gmail.com",defaultValue:e.email,name:"email",autoComplete:"off",style:{borderColor:n.email&&r.email||Z?"red":"#EDEDED"},onChange:l,onBlur:c})]}),(0,a.jsxs)("label",{className:"input-text",children:["Телефон *",(0,a.jsx)(u(),{type:"text",mask:"+7 (999) 999-99-99",className:"input",placeholder:"+791 502 31111",defaultValue:e.phone,name:"phone",autoComplete:"off",style:{borderColor:n.phone&&r.phone?"red":"#EDEDED"},onChange:l,onBlur:c})]}),(0,a.jsxs)("label",{className:"input-text",children:["Город *",(0,a.jsx)(i.gN,{type:"text",className:"input",placeholder:"Город",defaultValue:e.city&&e.city,name:"city",autoComplete:"off",style:{borderColor:n.city&&r.city?"red":"#EDEDED"},onChange:l,onBlur:c})]})]}),(0,a.jsxs)("label",{className:"input-text",children:["примечания",(0,a.jsx)("textarea",{cols:30,rows:10,className:"input textarea",defaultValue:""})]}),(0,a.jsxs)("div",{className:"checkout__instructions",children:[(0,a.jsx)("h4",{children:"Инструкция"}),(0,a.jsxs)("p",{children:["Получатель платежа:",(0,a.jsx)("span",{children:"БРЕНД-Инструмент"})]}),(0,a.jsxs)("p",{children:["Прием платежей по адресу:",(0,a.jsx)("span",{children:"Москва, Рязанский проспект, д.30, корп.2.ТЦ \xabРязанский\xbb, цокольный этаж."})]})]}),(0,a.jsxs)("div",{className:"checkout__total",children:[(0,a.jsx)("h4",{children:"Общая сумма к оплате"}),(0,a.jsxs)("p",{children:["Сумма:",(0,a.jsxs)("span",{children:[y," ₽"]})]}),(0,a.jsxs)("p",{children:["Итого:",(0,a.jsxs)("span",{children:[y," ₽"]})]})]}),(0,a.jsx)("label",{className:"input-btn",children:(0,a.jsx)("input",{type:"submit",value:"Оформить заказ",className:"input"})})]})]})}}),"-2"]})}),w&&(0,a.jsx)(_.Z,{succsesClick:q,html:!0,time:4e3,title:'Ваш заказ принят! История заказа находится в <Link  href="/orders/"><a href="">Личном кабинете</a></Link> . Для просмотра истории, перейдите по ссылке История заказов. Если у Вас возникли вопросы, пожалуйста свяжитесь с нами. Спасибо за покупки в нашем интернет-магазине!'})]})};function b(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Z,{title:"Оформление заказа",links:[{name:"Корзина",link:"/basket"}]}),(0,a.jsx)(y,{})]})}},1163:function(e,s,t){e.exports=t(3035)}},function(e){e.O(0,[332,888,774,179],function(){return e(e.s=5248)}),_N_E=e.O()}]);